2019-10-04 18:19:08,792 INFO com.danapprentech.promotion.PromotionApplication [restartedMain] Starting PromotionApplication on Amsal with PID 87992 (started by amsaljayadisihombing in /Users/amsaljayadisihombing/Documents/DANA/Dana Pulsa/Program/dtc_promotion)
2019-10-04 18:19:08,794 DEBUG com.danapprentech.promotion.PromotionApplication [restartedMain] Running with Spring Boot v2.1.8.RELEASE, Spring v5.1.9.RELEASE
2019-10-04 18:19:08,794 INFO com.danapprentech.promotion.PromotionApplication [restartedMain] The following profiles are active: prod
2019-10-04 18:19:12,727 INFO com.danapprentech.promotion.PromotionApplication [restartedMain] Started PromotionApplication in 4.147 seconds (JVM running for 5.813)
2019-10-04 18:19:19,677 INFO com.danapprentech.promotion.controllers.CouponController [http-nio-8084-exec-1] try to update coupon status
2019-10-04 18:19:19,695 INFO com.danapprentech.promotion.repositories.implementations.CouponRepository [http-nio-8084-exec-1] Entity manager SessionImpl(455964435<open>)
2019-10-04 18:19:19,699 INFO com.danapprentech.promotion.repositories.implementations.CouponRepository [http-nio-8084-exec-1] Entity manager SessionImpl(446832235<open>)
2019-10-04 18:19:19,699 INFO com.danapprentech.promotion.repositories.implementations.CouponRepository [http-nio-8084-exec-1] start query from Coupon where coupon_id = 'TCPN-1094c2c6-499a-48c9-b3c0-c269a71a10a3' 
2019-10-04 18:19:19,832 INFO com.danapprentech.promotion.repositories.implementations.MasterCouponRepository [http-nio-8084-exec-1] Entity manager SessionImpl(432470388<open>)
2019-10-04 18:19:19,850 INFO com.danapprentech.promotion.repositories.implementations.CouponRepository [http-nio-8084-exec-1] SessionImpl(446832235<open>)
2019-10-04 18:19:19,870 INFO com.danapprentech.promotion.repositories.implementations.CouponRepository [http-nio-8084-exec-1] Entity manager SessionImpl(401101241<open>)
2019-10-04 18:19:19,870 INFO com.danapprentech.promotion.repositories.implementations.CouponRepository [http-nio-8084-exec-1] start query from Coupon where coupon_id = 'TCPN-1094c2c6-499a-48c9-b3c0-c269a71a10a3' 
2019-10-04 18:20:11,778 ERROR org.hibernate.engine.jdbc.spi.SqlExceptionHelper [http-nio-8084-exec-1] Lock wait timeout exceeded; try restarting transaction
2019-10-04 18:20:11,783 WARN com.danapprentech.promotion.repositories.implementations.CouponRepository [http-nio-8084-exec-1] Error: could not extract ResultSet - [org.hibernate.internal.ExceptionConverterImpl.wrapLockException(ExceptionConverterImpl.java:273), org.hibernate.internal.ExceptionConverterImpl.convert(ExceptionConverterImpl.java:108), org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1515), org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1554), com.danapprentech.promotion.repositories.implementations.CouponRepository.getCouponDetailsById(CouponRepository.java:50), com.danapprentech.promotion.repositories.implementations.CouponRepository.updateStatus(CouponRepository.java:215), com.danapprentech.promotion.repositories.implementations.CouponRepository$$FastClassBySpringCGLIB$$927a5e.invoke(<generated>), org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218), org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:749), org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163), org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139), org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186), org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:295), org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:98), org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186), org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:688), com.danapprentech.promotion.repositories.implementations.CouponRepository$$EnhancerBySpringCGLIB$$a22732e5.updateStatus(<generated>), com.danapprentech.promotion.services.implementations.CouponService.updateStatus(CouponService.java:44), com.danapprentech.promotion.controllers.CouponController.couponRedeem(CouponController.java:156), java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method), java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62), java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43), java.base/java.lang.reflect.Method.invoke(Method.java:567), org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190), org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138), org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:104), org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:892), org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:797), org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87), org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1039), org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:942), org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1005), org.springframework.web.servlet.FrameworkServlet.doPut(FrameworkServlet.java:919), javax.servlet.http.HttpServlet.service(HttpServlet.java:663), org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:882), javax.servlet.http.HttpServlet.service(HttpServlet.java:741), org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231), org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166), org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53), org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193), org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166), org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:99), org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:118), org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193), org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166), org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:92), org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:118), org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193), org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166), org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:93), org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:118), org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193), org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166), org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:200), org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:118), org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193), org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166), org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202), org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96), org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:526), org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139), org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92), org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74), org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343), org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408), org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66), org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:860), org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1587), org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49), java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128), java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628), org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61), java.base/java.lang.Thread.run(Thread.java:835)]
2019-10-04 18:20:11,788 WARN com.danapprentech.promotion.controllers.CouponController [http-nio-8084-exec-1] Error: null
2019-10-04 18:20:11,788 WARN com.danapprentech.promotion.controllers.CouponController [http-nio-8084-exec-1] Stacktrace: com.danapprentech.promotion.controllers.CouponController.couponRedeem(CouponController.java:157)
2019-10-04 18:21:10,858 INFO com.danapprentech.promotion.test.controller.ControllerTest [main] Starting ControllerTest on Amsal with PID 88377 (started by amsaljayadisihombing in /Users/amsaljayadisihombing/Documents/DANA/Dana Pulsa/Program/dtc_promotion)
2019-10-04 18:21:10,860 DEBUG com.danapprentech.promotion.test.controller.ControllerTest [main] Running with Spring Boot v2.1.8.RELEASE, Spring v5.1.9.RELEASE
2019-10-04 18:21:10,860 INFO com.danapprentech.promotion.test.controller.ControllerTest [main] The following profiles are active: prod
2019-10-04 18:21:21,676 INFO com.danapprentech.promotion.PromotionApplication [restartedMain] Starting PromotionApplication on Amsal with PID 88428 (started by amsaljayadisihombing in /Users/amsaljayadisihombing/Documents/DANA/Dana Pulsa/Program/dtc_promotion)
2019-10-04 18:21:21,677 DEBUG com.danapprentech.promotion.PromotionApplication [restartedMain] Running with Spring Boot v2.1.8.RELEASE, Spring v5.1.9.RELEASE
2019-10-04 18:21:21,677 INFO com.danapprentech.promotion.PromotionApplication [restartedMain] The following profiles are active: prod
2019-10-04 18:21:25,487 INFO com.danapprentech.promotion.PromotionApplication [restartedMain] Started PromotionApplication in 4.262 seconds (JVM running for 5.161)
2019-10-04 18:21:30,609 INFO com.danapprentech.promotion.controllers.CouponController [http-nio-8084-exec-1] try to update coupon status
2019-10-04 18:21:30,625 INFO com.danapprentech.promotion.repositories.implementations.CouponRepository [http-nio-8084-exec-1] Entity manager SessionImpl(919089231<open>)
2019-10-04 18:21:30,628 INFO com.danapprentech.promotion.repositories.implementations.CouponRepository [http-nio-8084-exec-1] Entity manager SessionImpl(655368181<open>)
2019-10-04 18:21:30,628 INFO com.danapprentech.promotion.repositories.implementations.CouponRepository [http-nio-8084-exec-1] start query from Coupon where coupon_id = 'TCPN-1094c2c6-499a-48c9-b3c0-c269a71a10a3' 
2019-10-04 18:21:30,729 INFO com.danapprentech.promotion.repositories.implementations.MasterCouponRepository [http-nio-8084-exec-1] Entity manager SessionImpl(1730410806<open>)
2019-10-04 18:21:30,743 INFO com.danapprentech.promotion.repositories.implementations.CouponRepository [http-nio-8084-exec-1] SessionImpl(655368181<open>)
2019-10-04 18:21:30,760 INFO com.danapprentech.promotion.repositories.implementations.CouponRepository [http-nio-8084-exec-1] Entity manager SessionImpl(531945332<open>)
2019-10-04 18:21:30,760 INFO com.danapprentech.promotion.repositories.implementations.CouponRepository [http-nio-8084-exec-1] start query from Coupon where coupon_id = 'TCPN-1094c2c6-499a-48c9-b3c0-c269a71a10a3' 
2019-10-04 18:21:35,235 INFO com.danapprentech.promotion.controllers.CouponController [http-nio-8084-exec-4] try to get detail coupon
2019-10-04 18:21:35,253 INFO com.danapprentech.promotion.repositories.implementations.CouponRepository [http-nio-8084-exec-4] Entity manager SessionImpl(780741015<open>)
2019-10-04 18:21:35,253 INFO com.danapprentech.promotion.repositories.implementations.CouponRepository [http-nio-8084-exec-4] start query from Coupon where coupon_id = 'TCPN-7ee6dc44-8038-49ac-87be-eb0bc1509a63' 
2019-10-04 18:21:35,258 INFO com.danapprentech.promotion.repositories.implementations.MasterCouponRepository [http-nio-8084-exec-4] Entity manager SessionImpl(1716790518<open>)
2019-10-04 18:21:35,261 INFO com.danapprentech.promotion.repositories.implementations.CouponRepository [http-nio-8084-exec-4] SessionImpl(780741015<open>)
2019-10-04 18:21:35,286 INFO com.danapprentech.promotion.controllers.CouponController [http-nio-8084-exec-4] coupon exist with coupon id: TCPN-7ee6dc44-8038-49ac-87be-eb0bc1509a63
2019-10-04 18:21:47,261 INFO com.danapprentech.promotion.controllers.CouponController [http-nio-8084-exec-5] try to get coupon recommendation
2019-10-04 18:21:47,265 INFO com.danapprentech.promotion.repositories.implementations.CouponRepository [http-nio-8084-exec-5] Entity manager SessionImpl(304485366<open>)
2019-10-04 18:22:21,086 ERROR org.hibernate.engine.jdbc.spi.SqlExceptionHelper [http-nio-8084-exec-1] Lock wait timeout exceeded; try restarting transaction
2019-10-04 18:22:21,092 WARN com.danapprentech.promotion.repositories.implementations.CouponRepository [http-nio-8084-exec-1] Error: could not extract ResultSet - [org.hibernate.internal.ExceptionConverterImpl.wrapLockException(ExceptionConverterImpl.java:273), org.hibernate.internal.ExceptionConverterImpl.convert(ExceptionConverterImpl.java:108), org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1515), org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1554), com.danapprentech.promotion.repositories.implementations.CouponRepository.getCouponDetailsById(CouponRepository.java:50), com.danapprentech.promotion.repositories.implementations.CouponRepository.updateStatus(CouponRepository.java:215), com.danapprentech.promotion.repositories.implementations.CouponRepository$$FastClassBySpringCGLIB$$927a5e.invoke(<generated>), org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218), org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:749), org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163), org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139), org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186), org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:295), org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:98), org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186), org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:688), com.danapprentech.promotion.repositories.implementations.CouponRepository$$EnhancerBySpringCGLIB$$6e229118.updateStatus(<generated>), com.danapprentech.promotion.services.implementations.CouponService.updateStatus(CouponService.java:44), com.danapprentech.promotion.controllers.CouponController.couponRedeem(CouponController.java:156), java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method), java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62), java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43), java.base/java.lang.reflect.Method.invoke(Method.java:567), org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190), org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138), org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:104), org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:892), org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:797), org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87), org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1039), org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:942), org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1005), org.springframework.web.servlet.FrameworkServlet.doPut(FrameworkServlet.java:919), javax.servlet.http.HttpServlet.service(HttpServlet.java:663), org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:882), javax.servlet.http.HttpServlet.service(HttpServlet.java:741), org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231), org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166), org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53), org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193), org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166), org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:99), org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:118), org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193), org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166), org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:92), org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:118), org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193), org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166), org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:93), org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:118), org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193), org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166), org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:200), org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:118), org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193), org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166), org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202), org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96), org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:526), org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139), org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92), org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74), org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343), org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408), org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66), org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:860), org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1587), org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49), java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128), java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628), org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61), java.base/java.lang.Thread.run(Thread.java:835)]
2019-10-04 18:22:21,095 WARN com.danapprentech.promotion.controllers.CouponController [http-nio-8084-exec-1] Error: null
2019-10-04 18:22:21,095 WARN com.danapprentech.promotion.controllers.CouponController [http-nio-8084-exec-1] Stacktrace: com.danapprentech.promotion.controllers.CouponController.couponRedeem(CouponController.java:157)
2019-10-04 18:22:21,096 INFO com.danapprentech.promotion.repositories.implementations.MasterCouponRepository [http-nio-8084-exec-5] Entity manager SessionImpl(1427211337<open>)
2019-10-04 18:22:21,112 INFO com.danapprentech.promotion.controllers.CouponController [http-nio-8084-exec-5] Get coupon recommendation success with member id: USR-cff71cdf-e49a-44de-a0aa-e599267c8061
2019-10-04 18:22:53,029 INFO com.danapprentech.promotion.PromotionApplication [restartedMain] Starting PromotionApplication on Amsal with PID 88744 (started by amsaljayadisihombing in /Users/amsaljayadisihombing/Documents/DANA/Dana Pulsa/Program/dtc_promotion)
2019-10-04 18:22:53,030 DEBUG com.danapprentech.promotion.PromotionApplication [restartedMain] Running with Spring Boot v2.1.8.RELEASE, Spring v5.1.9.RELEASE
2019-10-04 18:22:53,031 INFO com.danapprentech.promotion.PromotionApplication [restartedMain] The following profiles are active: prod
2019-10-04 18:22:56,772 INFO com.danapprentech.promotion.PromotionApplication [restartedMain] Started PromotionApplication in 3.956 seconds (JVM running for 5.785)
2019-10-04 18:23:43,909 INFO com.danapprentech.promotion.controllers.CouponController [http-nio-8084-exec-1] try to update coupon status
2019-10-04 18:23:43,926 INFO com.danapprentech.promotion.repositories.implementations.CouponRepository [http-nio-8084-exec-1] Entity manager SessionImpl(1393203063<open>)
2019-10-04 18:23:43,928 INFO com.danapprentech.promotion.repositories.implementations.CouponRepository [http-nio-8084-exec-1] Entity manager SessionImpl(528592021<open>)
2019-10-04 18:23:43,928 INFO com.danapprentech.promotion.repositories.implementations.CouponRepository [http-nio-8084-exec-1] start query from Coupon where coupon_id = 'TCPN-1094c2c6-499a-48c9-b3c0-c269a71a10a3' 
2019-10-04 18:23:44,027 INFO com.danapprentech.promotion.repositories.implementations.MasterCouponRepository [http-nio-8084-exec-1] Entity manager SessionImpl(911302495<open>)
2019-10-04 18:23:44,037 INFO com.danapprentech.promotion.repositories.implementations.CouponRepository [http-nio-8084-exec-1] SessionImpl(528592021<open>)
2019-10-04 18:23:44,056 INFO com.danapprentech.promotion.repositories.implementations.CouponRepository [http-nio-8084-exec-1] Entity manager SessionImpl(1915257315<open>)
2019-10-04 18:23:44,056 INFO com.danapprentech.promotion.repositories.implementations.CouponRepository [http-nio-8084-exec-1] start query from Coupon where coupon_id = 'TCPN-1094c2c6-499a-48c9-b3c0-c269a71a10a3' 
2019-10-04 18:24:35,375 ERROR org.hibernate.engine.jdbc.spi.SqlExceptionHelper [http-nio-8084-exec-1] Lock wait timeout exceeded; try restarting transaction
2019-10-04 18:24:35,381 WARN com.danapprentech.promotion.repositories.implementations.CouponRepository [http-nio-8084-exec-1] Error: could not extract ResultSet - [org.hibernate.internal.ExceptionConverterImpl.wrapLockException(ExceptionConverterImpl.java:273), org.hibernate.internal.ExceptionConverterImpl.convert(ExceptionConverterImpl.java:108), org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1515), org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1554), com.danapprentech.promotion.repositories.implementations.CouponRepository.getCouponDetailsById(CouponRepository.java:50), com.danapprentech.promotion.repositories.implementations.CouponRepository.updateStatus(CouponRepository.java:215), com.danapprentech.promotion.repositories.implementations.CouponRepository$$FastClassBySpringCGLIB$$927a5e.invoke(<generated>), org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218), org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:749), org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163), org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139), org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186), org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:295), org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:98), org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186), org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:688), com.danapprentech.promotion.repositories.implementations.CouponRepository$$EnhancerBySpringCGLIB$$b14ce2ed.updateStatus(<generated>), com.danapprentech.promotion.services.implementations.CouponService.updateStatus(CouponService.java:44), com.danapprentech.promotion.controllers.CouponController.couponRedeem(CouponController.java:156), java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method), java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62), java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43), java.base/java.lang.reflect.Method.invoke(Method.java:567), org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190), org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138), org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:104), org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:892), org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:797), org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87), org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1039), org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:942), org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1005), org.springframework.web.servlet.FrameworkServlet.doPut(FrameworkServlet.java:919), javax.servlet.http.HttpServlet.service(HttpServlet.java:663), org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:882), javax.servlet.http.HttpServlet.service(HttpServlet.java:741), org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231), org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166), org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53), org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193), org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166), org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:99), org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:118), org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193), org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166), org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:92), org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:118), org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193), org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166), org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:93), org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:118), org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193), org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166), org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:200), org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:118), org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193), org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166), org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202), org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96), org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:526), org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139), org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92), org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74), org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343), org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408), org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66), org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:860), org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1587), org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49), java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128), java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628), org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61), java.base/java.lang.Thread.run(Thread.java:835)]
2019-10-04 18:24:35,383 WARN com.danapprentech.promotion.controllers.CouponController [http-nio-8084-exec-1] Error: null
2019-10-04 18:24:35,383 WARN com.danapprentech.promotion.controllers.CouponController [http-nio-8084-exec-1] Stacktrace: com.danapprentech.promotion.controllers.CouponController.couponRedeem(CouponController.java:157)
2019-10-04 18:25:11,873 INFO com.danapprentech.promotion.controllers.CouponController [http-nio-8084-exec-3] try to get coupon recommendation
2019-10-04 18:25:11,875 INFO com.danapprentech.promotion.repositories.implementations.CouponRepository [http-nio-8084-exec-3] Entity manager SessionImpl(217313940<open>)
2019-10-04 18:25:11,905 INFO com.danapprentech.promotion.repositories.implementations.MasterCouponRepository [http-nio-8084-exec-3] Entity manager SessionImpl(1210610596<open>)
2019-10-04 18:25:11,914 INFO com.danapprentech.promotion.controllers.CouponController [http-nio-8084-exec-3] Get coupon recommendation success with member id: USR-299c879a-90b0-4a5e-adf9-93a058d01029
